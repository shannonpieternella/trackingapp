<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neural Tracking - AI-Powered Analytics Platform</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/auth.css">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='50%' x='50%' text-anchor='middle' font-size='80'>âš¡</text></svg>">
</head>
<body>
  <div class="neural-container">
    <div class="login-wrapper">
      <div class="login-card fade-in">
        <div class="login-header">
          <div class="logo-animation">
            <div class="neural-network"></div>
            <h1 class="logo">Neural Tracking</h1>
          </div>
          <p class="tagline">AI-Powered Analytics Intelligence</p>
        </div>

        <!-- Login Form -->
        <form id="loginForm" class="auth-form">
        <div class="form-group">
          <input type="email" id="email" class="form-input" required placeholder=" ">
          <label class="form-label" for="email">Email Address</label>
        </div>

        <div class="form-group">
          <input type="password" id="password" class="form-input" required placeholder=" ">
          <label class="form-label" for="password">Password</label>
        </div>

        <div class="alert alert-error hidden" id="errorAlert"></div>

        <button type="submit" class="btn btn-primary btn-full">
          <span id="btnText">Launch Dashboard</span>
          <span class="spinner hidden" id="btnSpinner"></span>
        </button>

        <div class="auth-divider">
          <span>or</span>
        </div>

        <div class="text-center">
          <a href="#" id="showRegister" class="auth-link">
            Create new account
          </a>
        </div>
      </form>

      <!-- Register Form (Hidden by default) -->
      <form id="registerForm" class="auth-form hidden">
        <div class="form-group">
          <input type="text" id="regName" class="form-input" required placeholder=" ">
          <label class="form-label" for="regName">Full Name</label>
        </div>

        <div class="form-group">
          <input type="email" id="regEmail" class="form-input" required placeholder=" ">
          <label class="form-label" for="regEmail">Email Address</label>
        </div>

        <div class="form-group">
          <input type="password" id="regPassword" class="form-input" required placeholder=" ">
          <label class="form-label" for="regPassword">Password</label>
          <p class="form-hint">Minimum 6 characters</p>
        </div>

        <div class="form-group">
          <input type="text" id="regOrganization" class="form-input" placeholder=" ">
          <label class="form-label" for="regOrganization">Organization (Optional)</label>
        </div>

        <div class="alert alert-error hidden" id="regErrorAlert"></div>

        <button type="submit" class="btn btn-primary btn-full">
          <span id="regBtnText">Create Account</span>
          <span class="spinner hidden" id="regBtnSpinner"></span>
        </button>

        <div class="auth-divider">
          <span>or</span>
        </div>

        <div class="text-center">
          <a href="#" id="showLogin" class="auth-link">
            Sign in to existing account
          </a>
        </div>
      </form>
      </div>
    </div>
  </div>

  <script src="/js/api.js"></script>
  <script src="/js/animations.js"></script>
  <script>
    // Toggle between login and register forms
    document.getElementById('showRegister').addEventListener('click', (e) => {
      e.preventDefault();
      document.getElementById('loginForm').classList.add('hidden');
      document.getElementById('registerForm').classList.remove('hidden');
    });

    document.getElementById('showLogin').addEventListener('click', (e) => {
      e.preventDefault();
      document.getElementById('registerForm').classList.add('hidden');
      document.getElementById('loginForm').classList.remove('hidden');
    });

    // Handle login
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const errorAlert = document.getElementById('errorAlert');
      const btnText = document.getElementById('btnText');
      const btnSpinner = document.getElementById('btnSpinner');
      
      // Show loading state
      btnText.classList.add('hidden');
      btnSpinner.classList.remove('hidden');
      errorAlert.classList.add('hidden');
      
      try {
        await api.login(email, password);
        window.location.href = '/dashboard';
      } catch (error) {
        errorAlert.textContent = error.message || 'Login failed. Please try again.';
        errorAlert.classList.remove('hidden');
      } finally {
        btnText.classList.remove('hidden');
        btnSpinner.classList.add('hidden');
      }
    });

    // Handle registration
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const name = document.getElementById('regName').value;
      const email = document.getElementById('regEmail').value;
      const password = document.getElementById('regPassword').value;
      const organization = document.getElementById('regOrganization').value;
      const errorAlert = document.getElementById('regErrorAlert');
      const btnText = document.getElementById('regBtnText');
      const btnSpinner = document.getElementById('regBtnSpinner');
      
      // Show loading state
      btnText.classList.add('hidden');
      btnSpinner.classList.remove('hidden');
      errorAlert.classList.add('hidden');
      
      try {
        await api.register({ name, email, password, organization });
        window.location.href = '/dashboard';
      } catch (error) {
        errorAlert.textContent = error.message || 'Registration failed. Please try again.';
        errorAlert.classList.remove('hidden');
      } finally {
        btnText.classList.remove('hidden');
        btnSpinner.classList.add('hidden');
      }
    });

    // Check if already logged in
    if (localStorage.getItem('utm_token')) {
      window.location.href = '/dashboard';
    }
  </script>
</body>
</html>